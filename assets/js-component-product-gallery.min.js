(()=>{"use strict";const e=window.THEME_GLOBAL;class i extends HTMLElement{constructor(){super(),this.elSwiperWrapper=document.querySelector(this.dataset.swiperWrapper),this.elSwiper=this.elSwiperWrapper.querySelector("[data-swiper]"),this.elThumbs=this.elSwiperWrapper.querySelector("[data-gallery-thumb]"),this.elMobileSwiper=this.querySelector("[data-swiper-mobile]"),this.elsVideo=[...Array.from(this.querySelectorAll("video,iframe")),...Array.from(this.elSwiperWrapper.querySelectorAll("video,iframe"))],this.classList.add("product-section__gallery-images--not-loaded"),function(e){function i(){try{e()}catch(e){console.error(e)}}"loading"!==document.readyState?i():window.addEventListener("DOMContentLoaded",(()=>i()))}(this.initSlides.bind(this)),this.elSwiperWrapper.closest("modal-dialog").addEventListener("modal:hide",(()=>{this.stopVideos()}))}initSlides(){this.Swiper=window.Swiper,this.thumbs=new this.Swiper(this.elThumbs,{direction:"horizontal",slidesPerView:6,spaceBetween:10,watchSlidesProgress:!0,centerInsufficientSlides:!0,navigation:{nextEl:this.elThumbs.parentElement.querySelector("[data-swiper-next]"),prevEl:this.elThumbs.parentElement.querySelector("[data-swiper-prev]")},breakpoints:{[e.BREAKPOINT.TABLET_L]:{direction:"vertical",slidesPerView:7}}}),this.swiper=new this.Swiper(this.elSwiper,{navigation:{nextEl:this.elSwiper.parentElement.querySelector("[data-swiper-next]"),prevEl:this.elSwiper.parentElement.querySelector("[data-swiper-prev]")},watchSlidesProgress:!0,zoom:{maxRatio:3,toggle:!1},thumbs:{swiper:this.thumbs}}),this.swiper.on("click",this.onLightboxSlideClick.bind(this)),this.swiper.on("slideChange",this.stopVideos.bind(this)),this.swiper.on("doubleClick",this.onLightboxSlideDoubleClick.bind(this)),this.initMobileSwiper(),this.addEventListener("click",this.onImageClick.bind(this)),window.addEventListener("resize",this.initMobileSwiper.bind(this)),this.classList.remove("product-section__gallery-images--not-loaded")}onLightboxSlideClick(i,t){window.innerWidth<=e.BREAKPOINT.TABLET+1||this.matches(t,".swiper-slide")&&i.zoom.toggle()}onLightboxSlideDoubleClick(i,t){window.innerWidth>e.BREAKPOINT.TABLET+1||this.matches(t,".swiper-slide")&&(this.elSwiperWrapper.classList.toggle("product-section__lightbox-content--zoomed"),i.zoom.toggle())}onImageClick(e){if(!e.target.matches("[data-media]"))return;this.swiper.slideTo(e.target.dataset.media,0);const i=this.swiper.slides[this.swiper.realIndex]?.querySelector("iframe");i&&(this.controlVideo(i,"play"),i.addEventListener("load",(()=>{this.controlVideo(i,"play")})))}matches(e,i){return(e.path||e.composedPath&&e.composedPath())?.some((e=>e.matches&&e.matches(i)))}stopVideos(){this.elsVideo.forEach((e=>{"VIDEO"==e.tagName?e.pause&&e.pause():"IFRAME"===e.tagName&&this.controlVideo(e,"pause")}))}controlVideo(e,i="pause"){e.src.includes("vimeo")&&e.contentWindow.postMessage(JSON.stringify({method:i}),"*"),e.src.includes("youtube")&&e.contentWindow.postMessage(JSON.stringify({event:"command",func:`${i}Video`,args:""}),"*")}initMobileSwiper(){if(window.innerWidth>768)return this.mobileSwiper&&this.mobileSwiper.destroy(),this.notifySliderInit("remove"),void delete this.mobileSwiper;if(this.mobileSwiper)return;const e=this.elMobileSwiper.querySelector(".swiper-pagination");this.mobileSwiper=new this.Swiper(this.elMobileSwiper,{navigation:{nextEl:this.elMobileSwiper.parentElement.querySelector("[data-swiper-next]"),prevEl:this.elMobileSwiper.parentElement.querySelector("[data-swiper-prev]")},pagination:{el:e,clickable:!0},on:{init:()=>this.notifySliderInit(),slideChange:function(){this.stopVideos();const e=this.mobileSwiper.slides[this.mobileSwiper.realIndex]?.querySelector("video");e?.play&&e.play()}.bind(this)}})}notifySliderInit(e="add"){this.classList[e]("product-section__gallery-images--slider"),this.parentElement.classList[e]("product-section__gallery-inner--slider")}}customElements.define("product-gallery",i)})();